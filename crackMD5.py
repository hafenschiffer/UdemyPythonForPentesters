import hashlib
import argparse

#MD5 Hash 21232f297a57a5a743894a0e4a801fc3
#Clear text admin

parser = argparse.ArgumentParser(description='MD5 Cracker')
parser.add_argument('-md5', dest='hash', help='MD5 hash to be cracked', required=True)
parser.add_argument('-w', dest='wordlist', help='Wordlist to be used', required=True)

parsed_args = parser.parse_args()

def crackHash():
    hashCracked = ''
    file = open(parsed_args.wordlist, 'r')
    for line in file:
        line = line.strip()
        if hashlib.md5(bytes(line, encoding='utf-8')).hexdigest() == parsed_args.hash:
            hashCracked = line
            print('Hash has been cracked. Value is "%s"' % line)
    if hashCracked == '':
        print('\nFailed to crack hash. Try different dictionary.')

if __name__ == '__main__':
    crackHash()